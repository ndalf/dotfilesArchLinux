webpackJsonp([21],{2227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2228)},2228:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2229),c=n(87),u=n(308),l=n(2230),p=n(2231),d=n(2233),f=n(2237),h=function(e){function t(t,n,r,i,o,a,s,c,u,l,p,d,f){var h=e.call(this,u)||this;return h.constants=t,h.utilityService=n,h.settingsService=r,h.authenticationService=i,h.sxConfig=o,h.localizationService=a,h.eventingService=s,h.appStateService=c,h.loggingService=l,h.logger=p,h.actionCallbacks=d,h.dataCallbacks=f,h.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(h.getTheme(e))},h.initializeOnAppLaunchAndReinit("First Initialize"),h}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null,this.unbsubscribeFromAppStateChanges&&(this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=null)},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n)}),this.unbsubscribeFromAppStateChanges&&this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=this.eventingService.unsafeOnWithTenantScope(this.constants.events.appState.changed,function(e,n){t.onAppStateChanged(n)})},t.prototype.initializeLPC=function(){return o(this,void 0,void 0,function(){var e,t,n,r,o,c,u,l,p,d,f,h,v,g,y,m;return a(this,function(a){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];if(e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,o=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),c="Prod"!==o,u=this.settingsService.isInternalRing()&&!c,l=this.authenticationService.getUserTypeInTenant(),p=this.sxConfig.getCurrentSkypeMri(),d=l===teamspace.services.UserTypeInTenant.Guest,f=u&&!d?"df":"",!this.appStateService.isOnline)throw m="App is Offline",e.fail({message:m,clientCorrelationId:t,lpcRegion:f,userTypeInTenant:l}),new Error(m);h=this.getTeamsConfig(t,n,f,o),v=this.settingsService.getRing(),this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return g=v&&v.id?v.id:void 0,y=r,this.lpcPromise=s.initializeLivePersonaCardAsync(i(i({},h),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:g,hostAppVersion:y,options:{hostAppRing:g,hostAppVersion:y,isLoggedInAsTeamsGuestUser:d},loggedInUserTeamsMri:p})),this.lpcPromise.then(function(){var n=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:n,clientCorrelationId:t,lpcRegion:f,userTypeInTenant:l})}).catch(function(n){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:f,userTypeInTenant:l}),n}),[2,this.lpcPromise]}catch(n){throw m="Could not load live persona card: "+n,e.fail({message:m,clientCorrelationId:t,lpcRegion:f,userTypeInTenant:l}),new Error(m)}return[2]})})},t.prototype.createLPC=function(e,t){var n=t.profile,r=t.behavior,o=t.ariaLabel,a=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex,l=t.clientScenario,p=t.isSharedChannel,d=t.hostTenantId,f=t.hostConversationId,h=t.isExchangeOnlyContact,v=t.contactId;{if(this.isLivePersonaCardInitialized){var g=u.determineLPCPersonaType(n.role,n.type),y=u.getCleanUpn(n.userPrincipalName),m={personaInfo:{identifiers:{PersonaType:g,AadObjectId:n.objectId,TeamsMri:n.mri,OlsPersonaId:v,HostAppPersonaId:u.serializeHostAppPersonaId({userId:n.mri,isSharedChannel:p,hostTenantId:d,hostConversationId:f,isExchangeOnlyContact:h}),Upn:y,Smtp:n.email},skypeId:n.skypeId},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},r),ariaLabel:o,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:a,clientScenario:l};this.attachHoverTargetAsync(e,m);var _=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e)})}.bind(this);return{destroy:function(){_()}}}this.logger.error("Not initialized")}},t.prototype.onAppStateChanged=function(e){var t=e.prevState,n=t===teamspace.services.ApplicationState.Offline||t===teamspace.services.ApplicationState.Disconnected||t===teamspace.services.ApplicationState.Disabled;this.appStateService.isOnline&&n&&!this.isLivePersonaCardInitialized&&(s.freeBootstrapperMemory(window),this.initializeLPC())},t.prototype.attachHoverTargetAsync=function(e,t){window.LPC.addedPersonaToPageV2(e,t)},t.prototype.getTheme=function(e){switch(e){case c.LpcTheme.Dark:case c.LpcTheme.DarkV2:return d.darkTheme;case c.LpcTheme.HighContrast:return d.highContrastTheme;case c.LpcTheme.Default:case c.LpcTheme.DefaultV2:default:return d.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,n,r){var i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i}},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return o(t,void 0,void 0,function(){var t,i,o,s,c,u;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,o=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(o),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=a.sent())?n(c,e):r("Error retrieving auth token",e),[3,3];case 2:return u=a.sent(),this.logger.error("Error acquiring access token for LOKI"),r("Error retrieving auth token",e),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=h,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","appStateService","sxConfig","flatContactListService",function(e,t,n,r,i,o,a,s,c,u,d,v,g,y,m,_,b,T,S,P,C,A,w,I,k,E,O,D,L,B,R){var x=o.newLogger("LivePersonaCardService"),M=new f.LpcTelemetryHelper(O,o,u),U=M.logPanelActionEvent.bind(M),W=a.getUserTypeInTenant(),N=l.LPCActionCallbackFactory(s,e,x,y,u,c,_,g,D,m,i,U),G=p.LPCDataCallbackFactory(x,u,b,y,r,T,S,i,e,P,C,A,w,I,d,k,D,t,n,W,B,a,R);return new h(e,r,i,a,B,d,v,L,E,o,x,N,G)}])},2229:function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="https://lpcres.delve.office.com/lpc/versionless/",t(t.s=40)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},function(e,t,n){"use strict";function r(e){return"string"==typeof e}function i(e){return"number"==typeof e}function o(e){return"boolean"==typeof e}function a(e){return e instanceof Date}function s(e){return(e+v)*g}function c(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function u(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function l(e){return e<10?"0"+e:e.toString()}function p(e){return void 0===e||e===y||""===e}Object.defineProperty(t,"__esModule",{value:!0});var d=n(8),f=n(0),h=/[xy]/g,v=621355968e5,g=1e4,y=null;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var m=y,_=y,b=y;t.numberToBondInt64=function(e){var t=new d.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(h,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},t.isString=r,t.isNumber=i,t.isBoolean=o,t.isDate=a,t.msToTicks=s,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return m===y&&(m="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),m},t.isUint8ArrayAvailable=function(){return _===y&&(_="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!c()),_},t.isPriority=function(e){return!(!i(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||p(n)?y:(p(n.value)&&(n={value:n,type:f.AWTPropertyType.Unspecified}),n.type=function(e,t){switch(t=function(e){return!!(i(e)&&e>=0&&e<=4)}(t)?t:f.AWTPropertyType.Unspecified){case f.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return f.AWTPropertyType.String;case"boolean":return f.AWTPropertyType.Boolean;case"number":return f.AWTPropertyType.Double;case"object":return a(e)?f.AWTPropertyType.Date:y}return y}(e);case f.AWTPropertyType.String:return r(e)?t:y;case f.AWTPropertyType.Boolean:return o(e)?t:y;case f.AWTPropertyType.Date:return a(e)&&NaN!==e.getTime()?t:y;case f.AWTPropertyType.Int64:return i(e)&&e%1==0?t:y;case f.AWTPropertyType.Double:return i(e)?t:y}return y}(n.value,n.type),n.type?(a(n.value)&&(n.value=s(n.value.getTime())),n.pii>0&&n.cc>0?y:n.pii?function(e){return!!(i(e)&&e>=0&&e<=13)}(n.pii)?n:y:n.cc?function(e){return!!(i(e)&&e>=0&&e<=1)}(n.cc)?n:y:n):y)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+l(e.getUTCMonth()+1)+"-"+l(e.getUTCDate())+"T"+l(e.getUTCHours())+":"+l(e.getUTCMinutes())+":"+l(e.getUTCSeconds())+"."+function(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(b===y){var e=new XMLHttpRequest;b=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return b},t.useFetchRequest=function(){return c()||u()},t.isReactNative=c,t.isServiceWorkerGlobalScope=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.AWTPropertyType=r.AWTPropertyType,t.AWTPiiKind=r.AWTPiiKind,t.AWTEventPriority=r.AWTEventPriority,t.AWTEventsDroppedReason=r.AWTEventsDroppedReason,t.AWTEventsRejectedReason=r.AWTEventsRejectedReason,t.AWTCustomerContentKind=r.AWTCustomerContentKind;var i=n(6);t.AWTUserIdType=i.AWTUserIdType,t.AWTSessionState=i.AWTSessionState;var o=n(13);t.AWT_BEST_EFFORT=o.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=o.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=o.AWT_REAL_TIME;var a=n(7);t.AWTEventProperties=a.default;var s=n(14);t.AWTLogger=s.default;var c=n(18);t.AWTLogManager=c.default;var u=n(38);t.AWTTransmissionManager=u.default;var l=n(16);t.AWTSerializer=l.default;var p=n(10);t.AWTSemanticContext=p.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=this,r=0;r<this.listeners.length;++r)!function(r){n.listeners[r].eventsSent&&setTimeout(function(){return t.listeners[r].eventsSent(e)},0)}(r)},e.eventsDropped=function(e,t){for(var n=this,r=this,i=0;i<this.listeners.length;++i)!function(i){r.listeners[i].eventsDropped&&setTimeout(function(){return n.listeners[i].eventsDropped(e,t)},0)}(i)},e.eventsRetrying=function(e){for(var t=this,n=this,r=0;r<this.listeners.length;++r)!function(r){n.listeners[r].eventsRetrying&&setTimeout(function(){return t.listeners[r].eventsRetrying(e)},0)}(r)},e.eventsRejected=function(e,t){for(var n=this,r=this,i=0;i<this.listeners.length;++i)!function(i){r.listeners[i].eventsRejected&&setTimeout(function(){return n.listeners[i].eventsRejected(e,t)},0)}(i)},e.listeners=[],e}();t.default=r},function(e,t,n){"use strict";var r=n(9),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.a||i||Function("return this")();t.a=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),i=n(0),o=n(26),a=n(15),s=n(7),c=n(18),u=n(1),l=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout(function(){return e._batchAndSendEvents()},t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new o.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),a.default.initialize(function(e,n){if(t._config.canSendStatEvent("awt_stats")){var r=new s.default("awt_stats");for(var o in r.setEventPriority(i.AWTEventPriority.High),r.setProperty("TenantId",n),e)e.hasOwnProperty(o)&&r.setProperty(o,e[o].toString());c.default.getLogger(u.StatsApiKey).logEvent(r)}})},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var r=n;r>=0;--r)e[t][r]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var i=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(i)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===i.AWTEventPriority.Immediate_sync&&(e.priority=i.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){a.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=r.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=i.AWTEventPriority.High;++this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=i.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=i.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[r.AWT_REAL_TIME]=[4,2,1],this._profiles[r.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[r.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=r.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0),o=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified);var o={value:t,type:n,pii:i.AWTPiiKind.NotSet,cc:i.AWTCustomerContentKind.NotSet};null!==(o=r.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,o){void 0===o&&(o=i.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:n,cc:i.AWTCustomerContentKind.NotSet};null!==(a=r.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,o){void 0===o&&(o=i.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:i.AWTPiiKind.NotSet,cc:n};null!==(a=r.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=r;var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=i;var o=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=o},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(39))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(0),o=n(6),a=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(r.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext("UserInfo.IdType",n.toString());else{var r=void 0;switch(t){case i.AWTPiiKind.SipAddress:r=o.AWTUserIdType.SipAddress;break;case i.AWTPiiKind.PhoneNumber:r=o.AWTUserIdType.PhoneNumber;break;case i.AWTPiiKind.SmtpAddress:r=o.AWTUserIdType.EmailAddress;break;default:r=o.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",r.toString())}if(isNaN(t)||null===t||t===i.AWTPiiKind.NotSet||t>13)switch(n){case o.AWTUserIdType.Skype:t=i.AWTPiiKind.Identity;break;case o.AWTUserIdType.EmailAddress:t=i.AWTPiiKind.SmtpAddress;break;case o.AWTUserIdType.PhoneNumber:t=i.AWTPiiKind.PhoneNumber;break;case o.AWTUserIdType.SipAddress:t=i.AWTPiiKind.SipAddress;break;default:t=i.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i="MicrosoftApplicationsTelemetryDeviceId",o="MicrosoftApplicationsTelemetryFirstLaunchTime",a="MSIE",s="Chrome",c="Firefox",u="Safari",l="Edge",p="Electron",d="SkypeShell",f="PhantomJS",h="Windows",v="Mac OS X",g="Android",y=/(windows|win32)/i,m=/ arm;/i,_=/windows\sphone\s\d+\.\d+/i,b=/(macintosh|mac os x)/i,T=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,S=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,P=/android/i,C=/CrOS/i,A={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},w=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||"undefined"==typeof navigator||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(i),void this._deleteCookie(o);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(i),n=this._getData(o);t!==e&&(n=r.getISOString(new Date)),this._saveData(i,e),this._saveData(o,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(i);e||(e=r.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?"Opera":this._userAgentContainsString(f,e)?f:this._userAgentContainsString(l,e)||this._userAgentContainsString("Edg",e)?l:this._userAgentContainsString(p,e)?p:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?a:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(u,e)?u:this._userAgentContainsString(d,e)?d:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=r.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){if(t===a)return this._getIeVersion(e);if(t===l){var n=this._getOtherVersion(t,e);return"Unknown"===n?this._getOtherVersion("Edg",e):n}return this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(a+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===u&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e._getOsName=function(e){return e.match(_)?"Windows Phone":e.match(m)?"Windows RT":e.match(T)?"iOS":e.match(P)?g:e.match(S)?"Linux":e.match(b)?v:e.match(y)?h:e.match(C)?"Chrome OS":"Unknown"},e._getOsVersion=function(e,t){return t===h?this._getGenericOsVersion(e,"Windows NT"):t===g?this._getGenericOsVersion(e,t):t===v?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?A[n[1]]?A[n[1]]:n[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(v+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=this._getDelimiter(n);return r?n.split(r)[0]:n}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n],i=0;" "===r.charAt(i);)i++;if(0===(r=r.substring(i)).indexOf(e))return r.substring(e.length,r.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=w},function(e,n,r){"use strict";(function(e){var i=r(9),o="object"==typeof t&&t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o&&i.a.process,c=function(){try{return a&&a.require&&a.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();n.a=c}).call(this,r(20)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(6),o=n(7),a=n(1),s=n(15),c=n(3),u=n(5),l=n(19),p=n(17),d=n(10),f=n(11),h=function(){function e(e){this._apiKey=e,this._contextProperties=new o.default,this._semanticContext=new d.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,i)},e.prototype.setContextWithCustomerContent=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,i)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(l.default.loggingEnabled){this._apiKey||(this._apiKey=l.default.defaultTenantToken,this._createInitId());var n=!0;a.isString(t)?t={name:t}:t instanceof o.default&&(t=t.getEvent(),n=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(l.default.sessionEnabled){var o={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(o,n),o.priority=r.AWTEventPriority.High,t===i.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=a.newGuid(),this.setContext("Session.Id",this._sessionId),o.properties["Session.State"]="Started"}else{if(t!==i.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.properties["Session.Id"]=this._sessionId,o.properties["Session.State"]="Ended",o.properties["Session.Duration"]=s.toString(),o.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}o.properties["Session.FirstLaunchTime"]=f.default.firstLaunchTime,this.logEvent(o)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,i,o,a){if(t&&n){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,a),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=n,i&&(s.properties["Failure.Category"]=i),o&&(s.properties["Failure.Id"]=o),s.priority=r.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,n,r,i,o,a){if(t&&n){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,a),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=n,r&&(s.properties["PageView.Category"]=r),i&&(s.properties["PageView.Uri"]=i),o&&(s.properties["PageView.ReferrerUri"]=o),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=a.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof o.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&a.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(a.EventNameDotRegex,"_"),e.type&&a.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",a.EventNameAndTypeRegex.test(e.name)&&a.EventNameAndTypeRegex.test(e.type)?((!a.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,l.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",p.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),a.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),this._sendEvent(e)):c.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)):c.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:r.AWTPiiKind.NotSet,type:r.AWTPropertyType.String}},e._sendEvent=function(e){u.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var r in e.properties)e.properties.hasOwnProperty(r)&&(e.properties[r]=a.sanitizeProperty(r,e.properties[r]),null===e.properties[r]&&delete e.properties[r]);var i=e;return i.id=a.newGuid(),i.apiKey=t,i},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(3),o=n(0),a=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,i.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case o.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case o.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout(function(){return t.flush()},6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout(function(){return e.flush()},6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==r.StatsApiKey){var i=r.getTenantId(n);this._stats[i]||(this._stats[i]={}),this._stats[i][e]?this._stats[i][e]=this._stats[i][e]+t:this._stats[i][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(0),o=n(3),a=n(1),s=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,s=!1,c=new r.IO.MemoryStream,u=new r.CompactBinaryProtocolWriter(c);for(var l in u._WriteFieldBegin(r._BondDataType._BT_MAP,3,null),u._WriteMapContainerBegin(t,r._BondDataType._BT_STRING,r._BondDataType._BT_LIST),e)if(s)n||(n={}),n[l]=e[l],delete e[l];else if(e.hasOwnProperty(l)){u._WriteString(l);var p=e[l];u._WriteContainerBegin(1,r._BondDataType._BT_STRUCT),u._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),u._WriteString("act_default_source"),u._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),u._WriteString(a.newGuid()),u._WriteFieldBegin(r._BondDataType._BT_INT64,6,null),u._WriteInt64(a.numberToBondInt64(Date.now())),u._WriteFieldBegin(r._BondDataType._BT_LIST,8,null);var d=c._GetBuffer().length+1;u._WriteContainerBegin(e[l].length,r._BondDataType._BT_STRUCT);for(var f=c._GetBuffer().length-d,h=0;h<p.length;++h){var v=c._GetBuffer().length;if(this.writeEvent(p[h],u),c._GetBuffer().length-v>2936012)o.default.eventsRejected([p[h]],i.AWTEventsRejectedReason.SizeLimitExceeded),p.splice(h--,1),c._GetBuffer().splice(v),this._addNewDataPackageSize(p.length,c,f,d);else if(c._GetBuffer().length>2936012){c._GetBuffer().splice(v),n||(n={}),e[l]=p.splice(0,h),n[l]=p,this._addNewDataPackageSize(e[l].length,c,f,d),s=!0;break}}u._WriteStructEnd(!1)}return u._WriteStructEnd(!1),{payloadBlob:c._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,i){for(var o=r._Encoding._Varint_GetBytes(r.Number._ToUInt32(e)),a=0;a<n;++a){if(!(a<o.length)){t._GetBuffer().slice(i+a,n-a);break}t._GetBuffer()[i+a]=o[a]}},e.writeEvent=function(e,t){t._WriteFieldBegin(r._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(r._BondDataType._BT_INT64,3,null),t._WriteInt64(a.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(r._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},o=0,s={},c=0,u={},l=0,p={},d=0,f={},h=0,v={},g=0,y={},m=0;for(var _ in e.properties)if(e.properties.hasOwnProperty(_))if((T=e.properties[_]).cc>0)y[_]=T,m++;else if(T.pii>0)v[_]=T,g++;else switch(T.type){case i.AWTPropertyType.String:n[_]=T.value,o++;break;case i.AWTPropertyType.Int64:s[_]=T.value,c++;break;case i.AWTPropertyType.Double:u[_]=T.value,l++;break;case i.AWTPropertyType.Boolean:p[_]=T.value,d++;break;case i.AWTPropertyType.Date:f[_]=T.value,h++}if(o)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(o,r._BondDataType._BT_STRING,r._BondDataType._BT_STRING),n)if(n.hasOwnProperty(_)){var b=n[_];t._WriteString(_),t._WriteString(b.toString())}if(g)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(g,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),v)if(v.hasOwnProperty(_)){var T=v[_];t._WriteString(_),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(r._BondDataType._BT_INT32,2,null),t._WriteInt32(T.pii),t._WriteFieldBegin(r._BondDataType._BT_STRING,3,null),t._WriteString(T.value.toString()),t._WriteStructEnd(!1)}if(d)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(d,r._BondDataType._BT_STRING,r._BondDataType._BT_BOOL),p)p.hasOwnProperty(_)&&(b=p[_],t._WriteString(_),t._WriteBool(b));if(h)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),f)f.hasOwnProperty(_)&&(b=f[_],t._WriteString(_),t._WriteInt64(a.numberToBondInt64(b)));if(c)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(c,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),s)s.hasOwnProperty(_)&&(b=s[_],t._WriteString(_),t._WriteInt64(a.numberToBondInt64(b)));if(l)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(l,r._BondDataType._BT_STRING,r._BondDataType._BT_DOUBLE),u)u.hasOwnProperty(_)&&(b=u[_],t._WriteString(_),t._WriteDouble(b));if(m)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(m,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),y)y.hasOwnProperty(_)&&(T=y[_],t._WriteString(_),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(T.cc),t._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),t._WriteString(T.value.toString()),t._WriteStructEnd(!1));t._WriteStructEnd(!1)},e.base64Encode=function(e){return r._Encoding._Base64_GetString(e)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.6",t.FullVersionString="AWT-Web-JS-"+t.Version},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(6),o=n(19),a=n(14),s=n(5),c=n(3),u=n(11),l=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,o.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(o.default.sessionEnabled=!1),u.default.addPropertyStorageOverride(this._config.propertyStorageOverride),u.default.autoCollect(o.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),o.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(i.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return o.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(i.AWTSessionState.Ended),s.default.flushAndTeardown(),o.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),o.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithPii(e,t,n,i)},e.setContextWithCustomerContent=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,i)},e.getLogger=function(e){var t=e;return t&&t!==o.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new a.default(t)),this._loggers[t]},e.addNotificationListener=function(e){c.default.addNotificationListener(e)},e.removeNotificationListener=function(e){c.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(10),o=function(){function e(){}return e.logManagerContext=new r.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new i.default(!0,e.logManagerContext),e}();t.default=o},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,n,r){"use strict";(function(e){var i=r(4),o=r(22),a="object"==typeof t&&t&&!t.nodeType&&t,s=a&&"object"==typeof e&&e&&!e.nodeType&&e,c=s&&s.exports===a?i.a.Buffer:void 0,u=(c?c.isBuffer:void 0)||o.a;n.a=u}).call(this,r(20)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(27),o=n(5),a=n(37),s=n(3),c=n(1),u=500,l=function(){function e(e,t,n,o){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[r.AWTEventPriority.High]=[],this._inboundQueues[r.AWTEventPriority.Normal]=[],this._inboundQueues[r.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new a.default(this._outboundQueue,u),this._httpManager=new i.default(this._outboundQueue,e,this,n,o)}return e.prototype.addEvent=function(e){c.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),e.priority===r.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit?this._addEventToProperQueue(e):this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],r.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[r.AWTEventPriority.High][0].length>0||this._inboundQueues[r.AWTEventPriority.Normal][0].length>0||this._inboundQueues[r.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):s.default.eventsDropped([e[t][n]],r.AWTEventsDroppedReason.MaxRetryLimit);o.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(r.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout(function(){return t._uploadNow(e)},0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[r.AWTEventPriority.High][0].length+this._inboundQueues[r.AWTEventPriority.Normal][0].length+this._inboundQueues[r.AWTEventPriority.Low][0].length,this._inboundQueues[r.AWTEventPriority.High][0]=[],this._inboundQueues[r.AWTEventPriority.Normal][0]=[],this._inboundQueues[r.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[r.AWTEventPriority.High].shift(),this._inboundQueues[r.AWTEventPriority.Normal].shift(),this._inboundQueues[r.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[r.AWTEventPriority.High].push([]),this._inboundQueues[r.AWTEventPriority.Normal].push([]),this._inboundQueues[r.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=r.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],r.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=r.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(r.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent(function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout(function(){return t._uploadNow(t._uploadNowQueue.shift())},0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&o.default.scheduleTimer())})},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout(function(){return t._checkOutboundQueueEmptyAndSent(e)},250)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(16),o=n(34),a=n(35),s=n(36),c=n(17),u=n(1),l=n(3),p=n(5),d="POST",f=function(){function e(e,t,n,r,i){var o=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=r,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+c.FullVersionString,this._killSwitch=new a.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(i),u.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!u.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,r,i,a){try{if(u.useFetchRequest())fetch(e,{body:t,method:d}).then(function(e){var t={};e.headers&&e.headers.forEach(function(e,n){t[n]=e}),i(e.status,t)}).catch(function(e){r(0,{})});else if(u.useXDomainRequest()){var s=new XDomainRequest;s.open(d,e),s.onload=function(){i(200,null)},s.onerror=function(){r(400,null)},s.ontimeout=function(){n(500,null)},s.send(t)}else{var c=new XMLHttpRequest;c.open(d,e,!a),c.onload=function(){i(c.status,o._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.onerror=function(){r(c.status,o._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.ontimeout=function(){n(c.status,o._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.send(t)}}catch(e){r(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&p.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=r.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,o){var a=this;void 0===o&&(o=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,c="";for(var p in e)e.hasOwnProperty(p)&&(this._killSwitch.isTenantKilled(p)?(l.default.eventsRejected(e[p],r.AWTEventsRejectedReason.KillSwitch),delete e[p]):(c.length>0&&(c+=","),c+=p,s++));if(s>0){var d=i.default.getPayloadBlob(e,s);d.remainingRequest&&this._requestQueue.push(d.remainingRequest);var f=this._urlString+"&x-apikey="+c+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(f=f+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;for(var p in h=u.isUint8ArrayAvailable()?new Uint8Array(d.payloadBlob):i.default.base64Encode(d.payloadBlob),e)if(e.hasOwnProperty(p))for(var v=0;v<e[p].length;++v)e[p][v].sendAttempt>0?e[p][v].sendAttempt++:e[p][v].sendAttempt=1;if(this._useBeacons&&n&&u.isBeaconsSupported()&&navigator.sendBeacon(f,h))return;this._httpInterface.sendPOST(f,h,function(r,i){a._retryRequestIfNeeded(r,i,e,s,c,t,n,o)},function(r,i){a._retryRequestIfNeeded(r,i,e,s,c,t,n,o)},function(r,i){a._retryRequestIfNeeded(r,i,e,s,c,t,n,o)},n||o)}else n||this._handleRequestFinished(!1,{},n,o)}catch(e){this._handleRequestFinished(!1,{},n,o)}},e.prototype._retryRequestIfNeeded=function(e,t,n,i,a,s,c,u){var d=this,f=!0;if(void 0!==e){if(t){var h=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var v=0;v<h.length;++v)l.default.eventsRejected(n[h[v]],r.AWTEventsRejectedReason.KillSwitch),delete n[h[v]],i--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,c,u);(!o.default.shouldRetryForStatus(e)||i<=0)&&(f=!1)}if(f)if(u)this._activeConnections--,n[a][0].priority=r.AWTEventPriority.High,this._queueManager.addBackRequest(n);else if(s<1){for(var g in n)n.hasOwnProperty(g)&&l.default.eventsRetrying(n[g]);setTimeout(function(){return d._sendRequest(n,s+1,!1)},o.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,p.default.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,c,u)},e.prototype._handleRequestFinished=function(e,t,n,i){for(var o in e&&p.default.clearBackOff(),t)t.hasOwnProperty(o)&&(e?l.default.eventsSent(t[o]):l.default.eventsDropped(t[o],r.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,i||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),r=0;r<n.length;++r){var i=n[r].split(": ");t[i[0]]=i[1]}return t},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29);t._BondDataType=r._BondDataType;var i=n(30);t._Encoding=i;var o=n(33);t.IO=o;var a=n(8);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=i._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=i._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(i._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=i._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?r._BondDataType._BT_STOP_BASE:r._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=i._Varint_GetBytes(a.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=i._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(a.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(31),o=n(32);t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},t._Base64_GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],i=e.length%3,o=0,a=e.length-i;o<a;o+=3){var s=(e[o]<<16)+(e[o+1]<<8)+e[o+2];r.push([n.charAt((t=s)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(i){case 1:s=e[e.length-1],r.push(n.charAt(s>>2)),r.push(n.charAt(s<<4&63)),r.push("==");break;case 2:var c=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(c>>10)),r.push(n.charAt(c>>4&63)),r.push(n.charAt(c<<2&63)),r.push("=")}return r.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},t._Double_GetBytes=function(e){if(o.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],r=0;r<8;++r)n.push(t.getUint8(r));return n}return i.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=r.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,i=n<<1|t>>>31,o=t<<1;2147483648&n&&(i=~i,o=~o);var a=new r.UInt64("0");return a.low=o,a.high=i,a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,i=1-r,o=r,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),c=e-s,u=2*(r+2)+n,l=new Array(u),p=0;p<u;)l[p++]=0;for(p=r+2;p&&s;)l[--p]=s%2,s=Math.floor(s/2);for(p=r+1;p<u-1&&c>0;)(c*=2)>=1?(l[++p]=1,--c):l[++p]=0;for(var d=0;d<u&&!l[d];)d++;var f=r+1-d,h=d+n;if(l[h+1]){for(p=h;p>d&&(l[p]=1-l[p],!l);--p);p===d&&++f}if(f>o||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(f<i)return t?this._doubleZero:this._floatZero;if(t){var v=0;for(p=0;p<20;++p)v=v<<1|l[++d];for(var g=0;p<52;++p)g=g<<1|l[++d];return[255&g,g>>8&255,g>>16&255,g>>>24,255&(v=a<<31|2147483647&(v|=f+r<<20)),v>>8&255,v>>16&255,v>>>24]}var y=0;for(p=0;p<23;++p)y=y<<1|l[++d];return[255&(y=a<<31|2147483647&(y|=f+r<<23)),y>>8&255,y>>16&255,y>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(r.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var r=1e3*parseInt(t,10),i=0;i<n.length;++i)this._killedTokenDictionary[n[i]]=Date.now()+r}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout(function(){return e._reset()},6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===r.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=function(){function e(){}return e.setEventsHandler=function(e){r.default.setEventsHandler(e)},e.getEventsHandler=function(){return r.default.getEventsHandler()},e.scheduleTimer=function(){r.default.scheduleTimer()},e}();t.default=i},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,n){return new Promise(function(i,o){e?(r(F,e,n),i(e)):t(function(e,t){e?(r(F,e,n),i(e)):o(new G("GetAuthTokenError","Auth token is undefined",t))},function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";o(new G("GetAuthTokenError",r,t,n))})})}function o(e){return e}function a(e,t){var n=function(e){return"df"===e?W.Dogfood:"msit"===e?W.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return W.Dogfood;case"Msit":return W.MSIT;case"Blackforest":return W.Blackforest;case"GccModerate":return W.GccModerate;case"GccHigh":return W.GccHigh;case"DoD":return W.DOD;case"Gallatin":return W.Gallatin;case"Prod":return W.TopLevel;case"AG08":return W.AG08;case"AG09":return W.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return o(e)}}(t)),n}function s(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}function c(e,t,n){return l(function(e,t){var n=t||e.culture,r=a(e.region,e.complianceEnvironment);return q.replace("{0}",r).replace("{1}",n)}(t,s(J,n)),e,Q(Q({},t),{clientFeature:"LivePersonaCard"}),n)}function u(e,t,n){return l(function(e,t){var n=t||e.culture,r=a(e.region,e.complianceEnvironment);return V.replace("{0}",r).replace("{1}",n)}(t,s(ee,n)),e,Q(Q({},t),{clientFeature:"LivePersonaEditor"}),n)}function l(e,t,n,r){return new Promise(function(i,o){var a=new XMLHttpRequest;a.open("GET",e,!0),a.setRequestHeader("Authorization","Bearer "+t),a.setRequestHeader("Accept","application/json");var c=X.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});a.setRequestHeader("X-RootCorrelationId",c),a.setRequestHeader("X-CorrelationId",c),a.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),a.setRequestHeader("X-ClientFeature",n.clientFeature);var u=s(ne,r)||n.clientType;u&&a.setRequestHeader("X-ClientType",u),n.hostAppRing&&a.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&a.setRequestHeader("X-HostAppVersion",n.hostAppVersion),r&&r.React&&r.React.version&&r.ReactDOM&&a.setRequestHeader("X-HostAppReactVersion",r.React.version);var l=s($,r)||s(Z,r);l&&(a.setRequestHeader(Z,l),a.setRequestHeader($,l));var p=s(te,r);p&&a.setRequestHeader("X-"+te,p);var d=s(Y,r);d&&(a.setRequestHeader(Y,d),a.setRequestHeader("X-"+Y,d)),a.addEventListener("load",function(){if(200===a.status)try{var e=JSON.parse(a.response);e.RootCorrelationId=c,e.LokiVersion=a.getResponseHeader("x-serverversion")||"",i(e)}catch(e){o(new G("GetLokiConfigError","Failed to parse initialization config.",c))}else o(new G("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+a.status,c,!1,a.status))}),a.addEventListener("error",function(){o(new G("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",c))}),a.addEventListener("timeout",function(){o(new G("GetLokiConfigError","Loki config request timed out after "+K+" ms.",c))}),a.timeout=K,a.send()})}function p(e){return"exportOptions"in e&&Boolean(e.exportOptions&&"UserInteraction"===e.exportOptions.exportType)}function d(e,t){return e.hasOwnProperty(t)}function f(e){return"object"==typeof e&&!!e&&d(e,"family")&&d(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}function h(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}function v(e){return It.indexOf(e)>-1}function g(e){return-1===kt.indexOf(e)}function y(e){var t=e.targetWindow||window,n=Nt.get(t);return n||(n={bootstrapperConfig:Wt(Wt({},e),{targetWindow:t}),ariaLogger:new Ut(e),initializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshInitializationTimeout:void 0}),Nt.set(t,n),n}function m(e,t,n){return Gt(this,void 0,void 0,function(){var r,i;return Ft(this,function(o){switch(o.label){case 0:return(i=y(t)).lpcConfig?(r=i.lpcConfig,[3,3]):[3,1];case 1:return[4,_(e,t,n)];case 2:r=o.sent(),i.lpcConfig=r,o.label=3;case 3:return[2,r]}})})}function _(e,t,n){return Gt(this,void 0,void 0,function(){var r,o;return Ft(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,8]),[4,c(e,t,n)];case 1:return r=a.sent(),[3,8];case 2:return(o=a.sent()).statusCode&&401===o.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=a.sent(),a.label=4;case 4:return Ht<jt?(Ht++,[4,_(e,t,n)]):[3,6];case 5:return r=a.sent(),[3,7];case 6:throw o.numberOfRetries=Ht,o;case 7:return[3,8];case 8:return[2,r]}})})}function b(e,t){var n=this,r=0,i=function(e,t){return zt(n,void 0,void 0,function(){var n;return qt(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,T(e,t)];case 1:return o.sent(),[3,6];case 2:return n=o.sent(),r<Vt?(r++,[4,i(e,t)]):[3,4];case 3:return o.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return i(e,t)}function T(e,t){return new Promise(function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){n()}),i.addEventListener("error",function(){r(new G("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}function S(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources[Kt],i=e.Resources[Xt];"OwaPeopleHub"===e.Workload&&(i=e.Resources[Qt]),n=[r,i]}return Promise.all(n.map(function(e){return b(e,t)})).then(function(){return n})}function P(e,t){var n=t.targetWindow;return new Promise(function(r,i){setTimeout(function(){try{n.LPC||i(new G("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new G("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var o=function(e,t){var n=t.targetWindow;return{refreshAuthToken:C(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}}(e,t);n.LPC.start(o),r()}catch(e){i(new G("StartLivePersonaCardError",e.name))}},0)})}function C(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n,void 0)},function(e,n){t("",e,n,void 0)})}}function A(e){switch(e.complianceEnvironment){case"Blackforest":return Jt;case"GccHigh":return $t;case"DoD":return Yt;case"Gallatin":return en;case"AG08":return tn;case"AG09":return nn;case"GccModerate":case"Prod":default:return Zt}}function w(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}function I(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function k(e){return void 0===e||"string"!=typeof e||""===e||null===e}function E(e){return void 0===e||"function"!=typeof e}function O(e){var t="";if(e){var n=[];k(e.culture)&&n.push("culture"),k(e.clientType)&&n.push("clientType"),k(e.clientContextType)&&n.push("clientContextType"),k(e.clientCorrelationId)&&n.push("clientCorrelationId"),E(e.logMessage)&&n.push("logMessage"),E(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===an.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+an.join(", ")+" for pre-production environments. "),-1===sn.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+sn.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new G("ValidateBootstrapperConfigError",t)}function D(e,t,n){return cn(this,void 0,void 0,function(){var r,i;return un(this,function(o){switch(o.label){case 0:return(i=y(t)).lpeConfig?(r=i.lpeConfig,[3,3]):[3,1];case 1:return[4,L(e,t,n)];case 2:r=o.sent(),i.lpeConfig=r,o.label=3;case 3:return[2,r]}})})}function L(e,t,n){return cn(this,void 0,void 0,function(){var r,o;return un(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,8]),[4,u(e,t,n)];case 1:return r=a.sent(),[3,8];case 2:return(o=a.sent()).statusCode&&401===o.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=a.sent(),a.label=4;case 4:return pn<ln?(pn++,[4,D(e,t,n)]):[3,6];case 5:return r=a.sent(),[3,7];case 6:throw o.numberOfRetries=pn,o;case 7:return[3,8];case 8:return[2,r]}})})}function B(e,t){if(-1===e.Flights.indexOf(vn))return Promise.reject(new G("LoadLivePersonaEditorScriptError","LPE not enabled",e.RootCorrelationId));var n=[e.Resources[hn],e.Flights.indexOf(gn)>-1?e.Resources[dn]:e.Resources[fn]];return Promise.all(n.map(function(e){return b(e,t)})).then(function(){return n})}function R(e){return mn(this,void 0,void 0,function(){var t,n,r=this;return _n(this,function(o){return!bn&&rn?[2,rn]:(t=new on(window),n=y(e).ariaLogger,bn=!1,(rn=new Promise(function(o,a){return mn(r,void 0,void 0,function(){var r,s,c,u,l,p;return _n(this,function(d){switch(d.label){case 0:r=A(e),d.label=1;case 1:return d.trys.push([1,6,,7]),O(e),t.startCustomTiming(Pt.getAuthToken),[4,i(e.authToken,e.getAuthToken,window)];case 2:return s=d.sent(),t.endCustomTiming(Pt.getAuthToken),t.measureFromStart(Pt.getAuthTokenFromStart),t.startCustomTiming(Pt.getLokiConfig),[4,D(s,e,window)];case 3:return c=d.sent(),t.endCustomTiming(Pt.getLokiConfig),t.measureFromStart(Pt.getLokiConfigFromStart),t.startCustomTiming(Pt.getLpeBundles),[4,B(c,window)];case 4:return d.sent(),t.endCustomTiming(Pt.getLpeBundles),t.measureFromStart(Pt.getLpeBundlesFromStart),[4,n.updateContextWithLokiDataAsync(c,r).catch(function(){console.log("Live Persona Editor ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return d.sent(),(u=I(t.getAllTimings())).RootCorrelationId=c.RootCorrelationId,u.isConsumer=e.isConsumer,n.logEventAsync({name:"initializeLivePersonaEditor_success",properties:u},r),o(c),[3,7];case 6:return l=d.sent(),p=I(t.getAllTimings()),n.logEventAsync({name:"initializeLivePersonaEditor_failure",properties:yn(yn(yn({},w(l)),p),{isConsumer:e.isConsumer})},r),a("Failed to initialize Live Persona Editor: "+l.name+" "+l.message),[3,7];case 7:return[2]}})})})).catch(function(){setTimeout(function(){bn=!0},N)}),[2,rn])})})}function x(e){return Sn(this,void 0,void 0,function(){var t,n,r,o,a=this;return Pn(this,function(s){return t=y(e),n=function(){return y(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(r=t.bootstrapperConfig.targetWindow,o=new on(r),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(s,c){return Sn(a,void 0,void 0,function(){var a,u,l,p,d,f;return Pn(this,function(h){switch(h.label){case 0:a=A(e),h.label=1;case 1:return h.trys.push([1,7,,8]),O(e),o.startCustomTiming(Pt.getAuthToken),[4,i(e.authToken,e.getAuthToken,r)];case 2:return u=h.sent(),o.endCustomTiming(Pt.getAuthToken),o.measureFromStart(Pt.getAuthTokenFromStart),o.startCustomTiming(Pt.getLokiConfig),[4,m(u,e,r)];case 3:return l=h.sent(),o.endCustomTiming(Pt.getLokiConfig),o.measureFromStart(Pt.getLokiConfigFromStart),o.startCustomTiming(Pt.getLpcBundles),[4,S(l,r)];case 4:return h.sent(),o.endCustomTiming(Pt.getLpcBundles),o.measureFromStart(Pt.getLpcBundlesFromStart),o.startCustomTiming(Pt.startLpc),[4,P(l,t.bootstrapperConfig)];case 5:return h.sent(),o.endCustomTiming(Pt.startLpc),o.measureFromStart(Pt.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(l,a).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return h.sent(),(p=I(o.getAllTimings())).RootCorrelationId=l.RootCorrelationId,p.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:p},a),s(),[3,8];case 7:return d=h.sent(),f=I(o.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:Tn(Tn(Tn({},w(d)),f),{isConsumer:e.isConsumer})},a),c("Failed to initialize Live Persona Card: "+d.name+" "+d.message),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=window.setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},N)}),[2,t.initializationPromise])})})}function M(e){!function(e){var t=Nt.get(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing,delete n.LPE),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}Nt.delete(e)}(e)}function U(e){return Sn(this,void 0,void 0,function(){var t;return Pn(this,function(n){switch(n.label){case 0:return t=y(e),[4,i(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,m(n.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}n.r(t),n.d(t,"initializeLivePersonaEditorAsync",function(){return R}),n.d(t,"initializeLivePersonaCardAsync",function(){return x}),n.d(t,"freeBootstrapperMemory",function(){return M}),n.d(t,"fetchLokiConfigAsync",function(){return U});var W,N=3e5,G=function(e,t,n,r,i,o){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=o},F="LokiAuthToken";!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(W||(W={}));var j,H,z,q="{0}/api/v1/livepersonacard/configuration?cultureName={1}",V="{0}/api/v1/livepersonaeditor/configuration?cultureName={1}",X="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",Q=function(){return(Q=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},K=6e4,Z="LivePersonaCardVersionOverride",J="LivePersonaCardCultureOverride",$="MidgardVersion",Y="MidgardBranch",ee="LivePersonaEditorCultureOverride",te="LivePersonaEditorVersionOverride",ne="ClientTypeOverride",re=n(2);!function(){function e(e){this.consumers=e||[]}e.prototype.broadcastEvent=function(e){e&&this.consumers.forEach(function(t){t.canConsumeEvent(e)&&t.consume(e)})},e.prototype.broadcastFlush=function(){return Promise.all(this.consumers.map(function(e){return e.flush()})).then()},e.prototype.broadcastDestroy=function(){this.consumers.forEach(function(e){e.destroy()})},e.prototype.registerConsumer=function(e){this.consumers.push(e)}}(),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(j||(j={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.RequiredDiagnosticData=10]="RequiredDiagnosticData",e[e.OptionalDiagnosticData=100]="OptionalDiagnosticData",e[e.RequiredServiceData=110]="RequiredServiceData",e[e.AlwaysOnRequiredServiceData=120]="AlwaysOnRequiredServiceData"}(H||(H={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(z||(z={})),function(){function e(e,t,n,r,i){void 0===t&&(t="NO_USER"),void 0===n&&(n="NO_USER"),void 0===r&&(r="NO_TENANT"),void 0===i&&(i="NO_REGION"),this.eventMapper=e,this._userAadObjectId=t,this._userPuid=n,this._tenantAadObjectId=r,this._lokiRegion=i}e.prototype.getCommonProperties=function(e){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:p(e),isConsoleLogger:!0}},e.prototype.canConsumeEvent=function(e){return!0},e.prototype.consume=function(e){if(e){var t=this.getCommonProperties(e),n=this.eventMapper({event:e,additionalProperties:t});n?(Array.isArray(n)||(n=[n]),n.forEach(function(e){var t,n=null===(t=e.awtEventData.properties)||void 0===t?void 0:t.eventId;try{var r=e.awtEventData.properties.properties&&JSON.parse(e.awtEventData.properties.properties);r&&(e.awtEventData.properties.properties=r)}catch(e){}console.log("%cLog: "+(e.awtEventData.name||e.awtEventData.Name)+" "+(n?"| "+n:"")+" | Level: "+H[e.diagnosticLevel]+" | Category: "+(j[e.dataCategories]||e.dataCategories)+"\n","font-weight: bold",e)})):console.log(JSON.parse(JSON.stringify(e)))}},e.prototype.flush=function(){return Promise.resolve()},e.prototype.destroy=function(){}}();var ie,oe={Generic:"",GDPR:""},ae={Prod:{Generic:"33d70a864599496b982a39f036f71122-2064703e-3a9d-4d90-8362-eec08dffe8e8-7176",GDPR:""},Dev:{Generic:"ceb930c7c5d041e899b6de945bc4c6ee-e9ee0db4-0fa5-437b-966d-e8b2950f8d7d-7290",GDPR:""},Blackforest:oe,GccHigh:oe,DoD:oe,Gallatin:oe,AG08:oe,AG09:oe},se={LivePeopleCards:{Prod:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-9277d376-40b1-48ec-92f5-b2ee3f44345b-7212",GDPR:"f615f561ec88437db01f752caf151695-7cf4617b-dcbd-4b5b-a5eb-0079c1ba008a-6975"},Dev:oe,Blackforest:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-eb71f759-e748-47d9-922a-96d2522430e4-7094",GDPR:"f615f561ec88437db01f752caf151695-18332f16-126d-42b9-a2f4-2dd55a1ec030-6918"},GccHigh:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-5bace7e6-5357-46f3-88e0-449f4eaacb40-7215",GDPR:"f615f561ec88437db01f752caf151695-d48bf8b4-e399-433b-bb04-f0d344722fe4-7383"},DoD:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-7e485978-0dca-4684-abdd-5bcebedd8f2f-7631",GDPR:"f615f561ec88437db01f752caf151695-e653e3c7-d1be-444c-832d-d3707d03bbcd-6862"},Gallatin:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-99d02291-5114-42b3-aa94-ddd964108c06-7145",GDPR:"f615f561ec88437db01f752caf151695-9728472d-c6e2-4067-a597-f0a9e261a858-6852"},AG08:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-e74e132e-f357-44eb-a0b7-941458772fc3-6908",GDPR:"f615f561ec88437db01f752caf151695-c0a58d75-92c7-4136-ac9f-a689166bf700-6735"},AG09:oe},LivePersonaPicker:{Prod:{Generic:"67199ce661b3472494bbec0bf2e06c27-c34071ab-96bc-40d9-9162-7a83b521b4dd-7282",GDPR:"30b97846c6c640ed90e3b4e06d98a986-b6251ed6-9d7f-4e24-8ace-044e9613d08b-7662"},Dev:oe,Blackforest:oe,GccHigh:oe,DoD:oe,Gallatin:oe,AG08:oe,AG09:oe},OfficeFeed:{Prod:{Generic:"60dd0301e6c846e9b0699cbbe259efb6-c35f87eb-1000-4625-8cab-d2dd316a0ea6-7539",GDPR:"dc2f4eb67f454d4187656e6aa9063e83-ed148abb-5cbb-42bd-9cfc-298b1dd8c444-7942"},Dev:oe,Blackforest:oe,GccHigh:oe,DoD:oe,Gallatin:oe,AG08:oe,AG09:oe},LivePersonaEditor:{Prod:{Generic:"77af0c0ae9af49e684693d42352c0cf7-9d604ea0-ea41-4c75-8897-d7dbb0c7f7e9-7006",GDPR:"d2aac9418005423daf110f7008485383-d48b2953-983d-4b8b-857a-9f724d685b97-7218"},Dev:oe,Blackforest:{Generic:"77af0c0ae9af49e684693d42352c0cf7-2c4a13e2-2fef-4ba6-a12a-a369ed907ff9-7140",GDPR:"d2aac9418005423daf110f7008485383-b85d1253-d229-42c8-9cf6-b8ae20c4b61b-7439"},GccHigh:{Generic:"77af0c0ae9af49e684693d42352c0cf7-8b12b5b0-234b-4f96-a57b-dcf09a10401e-7221",GDPR:"d2aac9418005423daf110f7008485383-ee34f80b-d66c-4c0a-9a75-bd32d151a28d-7184"},DoD:{Generic:"77af0c0ae9af49e684693d42352c0cf7-48932264-dbbc-45fe-9173-0ace4b216b7a-7229",GDPR:"d2aac9418005423daf110f7008485383-5cb0db99-dc8f-4b1e-9076-43821ee4622f-7316"},Gallatin:{Generic:"77af0c0ae9af49e684693d42352c0cf7-531738b2-25b2-424a-b4a8-20fbdae1eed8-7390",GDPR:"d2aac9418005423daf110f7008485383-583a5fc4-1880-4f24-afe4-96ebcba895d1-7235"},AG08:oe,AG09:oe},MicrosoftSearch:ae,MicrosoftSearch3S:ae,OrgExplorer:{Prod:{Generic:"4ed6dab22bbc45efbd6427253faa4673-1052ea5c-f672-4ea9-a7c9-da17fc53f249-7272",GDPR:""},Dev:oe,Blackforest:oe,GccHigh:oe,DoD:oe,Gallatin:oe,AG08:oe,AG09:oe},NamePronunciation:{Prod:{Generic:"cdba0d01d3c24f188e55845778e5505d-a9c8b79c-ea70-49e9-9352-507b2a8df76f-6790",GDPR:""},Dev:{Generic:"c47a2f5cb4e24f409e35cef5e23ac962-73b83934-404c-41d4-b3f1-2296bb746aa1-7252",GDPR:""},Blackforest:oe,GccHigh:oe,DoD:oe,Gallatin:oe,AG08:oe,AG09:oe},CortexTopics:{Prod:{Generic:"8f7cccc3c534426e8894f45b76e666b9-b80f2549-ddb1-4588-8602-f54037a070e7-7552",GDPR:""},Dev:oe,Blackforest:oe,GccHigh:oe,DoD:oe,Gallatin:oe,AG08:oe,AG09:oe}},ce=(function(){function e(e,t,n,r,i,o,a){var s=this;if(this._userAadObjectId=e,this._userPuid=t,this._tenantAadObjectId=n,this._lokiRegion=r,this.eventMapper=i,this.options=o,this.propertyMap={},this.memoryPropertyStorageOverride={setProperty:function(e,t){s.propertyMap[e]=t},getProperty:function(e){return s.propertyMap[e]||""}},!o.forceIntegratedLogger&&a){var c=a;o.isGDPRIntegratedLoggerDisabled||(c=this.initializeAriaSDKAndGetLogFunction(se[o.tenant][o.environment].GDPR,o.environment)),this.loggers={logRegularEvent:a,logGDPREvent:c}}else this.initializeAriaSDK(se[o.tenant][o.environment].Generic,o.environment),this.loggers={logRegularEvent:this.logToAria,logGDPREvent:this.logToAria}}e.prototype.getCommonProperties=function(e){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:p(e)}},e.prototype.logToAria=function(e,t){re.AWTLogManager.getLogger(t).logEvent(e.awtEventData)},e.prototype.logWith=function(e,t,n){Array.isArray(t)?t.forEach(function(t){return e(t,n)}):e(t,n)},e.prototype.initializeAriaSDK=function(e,t){var n=void 0;switch(t){case"Blackforest":n=re.AWT_COLLECTOR_URL_GERMANY;break;case"GccHigh":n=re.AWT_COLLECTOR_URL_USGOV_DOJ;break;case"DoD":n=re.AWT_COLLECTOR_URL_USGOV_DOD;break;case"AG08":n="https://collector.azure.eaglex.ic.gov/Collector/3.0/";break;case"AG09":n="";break;case"Dev":case"Gallatin":case"Prod":break;default:o(t)}return re.AWTLogManager.initialize(e,{collectorUri:n,enableAutoUserSession:Boolean(this.options.enableAutoUserSession),disableCookiesUsage:!0,propertyStorageOverride:this.memoryPropertyStorageOverride})},e.prototype.initializeAriaSDKAndGetLogFunction=function(e,t){return this.initializeAriaSDK(e,t),this.logToAria},e.prototype.canConsumeEvent=function(e){return!0},e.prototype.consume=function(e){var t=this.options,n=t.environment,r=t.tenant,i=this.getCommonProperties(e);if(p(e)){var o=this.eventMapper&&this.eventMapper({event:e,additionalProperties:i,eventNameOverride:e.exportOptions.exportName});if(!o)return;this.logWith(this.loggers.logGDPREvent,o,se[r][n].GDPR)}var a=this.eventMapper&&this.eventMapper({event:e,additionalProperties:i});a&&this.logWith(this.loggers.logRegularEvent,a,se[r][n].Generic)},e.prototype.flush=function(){return new Promise(function(e){re.AWTLogManager.flush(function(){e()})})},e.prototype.destroy=function(){re.AWTLogManager.flushAndTeardown()},Object.defineProperty(e.prototype,"userAadObjectId",{set:function(e){""!==e&&(this._userAadObjectId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userPuid",{set:function(e){""!==e&&(this._userPuid=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenantAadObjectId",{set:function(e){""!==e&&(this._tenantAadObjectId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lokiRegion",{set:function(e){""!==e&&(this._lokiRegion=e)},enumerable:!1,configurable:!0})}(),n(4)),ue=ce.a.Symbol,le=Object.prototype,pe=le.hasOwnProperty,de=le.toString,fe=ue?ue.toStringTag:void 0,he=function(e){var t=pe.call(e,fe),n=e[fe];try{e[fe]=void 0;var r=!0}catch(e){}var i=de.call(e);return r&&(t?e[fe]=n:delete e[fe]),i},ve=Object.prototype.toString,ge=function(e){return ve.call(e)},ye=ue?ue.toStringTag:void 0,me=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ye&&ye in Object(e)?he(e):ge(e)},_e=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},be=function(e){if(!_e(e))return!1;var t=me(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Te=ce.a["__core-js_shared__"],Se=(ie=/[^.]+$/.exec(Te&&Te.keys&&Te.keys.IE_PROTO||""))?"Symbol(src)_1."+ie:"",Pe=function(e){return!!Se&&Se in e},Ce=Function.prototype.toString,Ae=function(e){if(null!=e){try{return Ce.call(e)}catch(e){}try{return e+""}catch(e){}}return""},we=/^\[object .+?Constructor\]$/,Ie=Function.prototype,ke=Object.prototype,Ee=Ie.toString,Oe=ke.hasOwnProperty,De=RegExp("^"+Ee.call(Oe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Le=function(e){return!(!_e(e)||Pe(e))&&(be(e)?De:we).test(Ae(e))},Be=function(e,t){return null==e?void 0:e[t]},Re=function(e,t){var n=Be(e,t);return Le(n)?n:void 0},xe=function(){try{var e=Re(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Me=function(e,t,n){"__proto__"==t&&xe?xe(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Ue=function(e,t){return e===t||e!=e&&t!=t},We=Object.prototype.hasOwnProperty,Ne=function(e,t,n){var r=e[t];We.call(e,t)&&Ue(r,n)&&(void 0!==n||t in e)||Me(e,t,n)},Ge=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?Me(n,s,c):Ne(n,s,c)}return n},Fe=function(e){return e},je=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},He=Math.max,ze=function(e,t,n){return t=He(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=He(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),je(e,this,s)}},qe=function(e){return function(){return e}},Ve=xe?function(e,t){return xe(e,"toString",{configurable:!0,enumerable:!1,value:qe(t),writable:!0})}:Fe,Xe=Date.now,Qe=function(e){var t=0,n=0;return function(){var r=Xe(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Ve),Ke=function(e,t){return Qe(ze(e,t,Fe),e+"")},Ze=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Je=function(e){return null!=e&&Ze(e.length)&&!be(e)},$e=/^(?:0|[1-9]\d*)$/,Ye=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&$e.test(e))&&e>-1&&e%1==0&&e<t},et=function(e,t,n){if(!_e(n))return!1;var r=typeof t;return!!("number"==r?Je(n)&&Ye(t,n.length):"string"==r&&t in n)&&Ue(n[t],e)},tt=Object.prototype,nt=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||tt)},rt=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},it=function(e){return null!=e&&"object"==typeof e},ot=function(e){return it(e)&&"[object Arguments]"==me(e)},at=Object.prototype,st=at.hasOwnProperty,ct=at.propertyIsEnumerable,ut=ot(function(){return arguments}())?ot:function(e){return it(e)&&st.call(e,"callee")&&!ct.call(e,"callee")},lt=Array.isArray,pt=n(21),dt={};dt["[object Float32Array]"]=dt["[object Float64Array]"]=dt["[object Int8Array]"]=dt["[object Int16Array]"]=dt["[object Int32Array]"]=dt["[object Uint8Array]"]=dt["[object Uint8ClampedArray]"]=dt["[object Uint16Array]"]=dt["[object Uint32Array]"]=!0,dt["[object Arguments]"]=dt["[object Array]"]=dt["[object ArrayBuffer]"]=dt["[object Boolean]"]=dt["[object DataView]"]=dt["[object Date]"]=dt["[object Error]"]=dt["[object Function]"]=dt["[object Map]"]=dt["[object Number]"]=dt["[object Object]"]=dt["[object RegExp]"]=dt["[object Set]"]=dt["[object String]"]=dt["[object WeakMap]"]=!1;var ft=n(12),ht=ft.a&&ft.a.isTypedArray,vt=ht?function(e){return function(t){return e(t)}}(ht):function(e){return it(e)&&Ze(e.length)&&!!dt[me(e)]},gt=Object.prototype.hasOwnProperty,yt=function(e,t){var n=lt(e),r=!n&&ut(e),i=!n&&!r&&Object(pt.a)(e),o=!n&&!r&&!i&&vt(e),a=n||r||i||o,s=a?rt(e.length,String):[],c=s.length;for(var u in e)!t&&!gt.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ye(u,c))||s.push(u);return s},mt=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),_t=Object.prototype.hasOwnProperty,bt=function(e){if(!nt(e))return mt(e);var t=[];for(var n in Object(e))_t.call(e,n)&&"constructor"!=n&&t.push(n);return t},Tt=function(e){return Je(e)?yt(e):bt(e)},St=Object.prototype.hasOwnProperty;!function(e){Ke(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&et(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t})}(function(e,t){if(nt(t)||Je(t))Ge(t,Tt(t),e);else for(var n in t)St.call(t,n)&&Ne(e,n,t[n])});var Pt,Ct="Unknown",At="ClientTimeStamp",wt={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"},It=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus"],kt=["Stikkontakt","DataLoadStartAction","NoLogging","None"],Et=function(){return(Et=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ot=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Dt=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Lt=function(){function e(e,t,n,r,i,o,a){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=r,this.staticProperties=i,this.lookupError=o,this.isVerboseLoggingEnabled=a,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=wt.MONITOR_IN_INVALID_STATE,this.transactionId=function(){for(var e=h(),t=0,n="",r=0;r<36;r++)switch(r){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[r-t]%4+8).toString(16);break;default:n+=(e[r-t]%16).toString(16)}return n}(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush()})},e.prototype.success=function(e,t){this.endEvent(e,wt.SUCCESS,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,wt.EXPECTED_FAILURE,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,wt.UNEXPECTED_FAILURE,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,wt.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=wt.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return Ot(this,void 0,void 0,function(){var r,i,o,a,s,c;return Dt(this,function(u){switch(u.label){case 0:return!g(this.featureName)||v(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(r=e?this.scenarioName+"_"+t+"_"+e:this.scenarioName+"_"+t,[4,this.eventHubPromise]):[3,5];case 1:return i=u.sent(),a=(o=i).broadcastEvent,c={eventId:r,version:this.monitoringData.version?this.monitoringData.version:Ct,type:"QoS"},n&&f(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return s=u.sent(),[3,4];case 3:s=void 0,u.label=4;case 4:a.apply(o,[(c.midgardError=s,c.source=this.monitoringData.source,c.featureName=this.featureName,c.clientCorrelationid=this.monitoringData.clientCorrelationId,c.qosScenarioName=this.scenarioName,c.qosEventType=t,c.qosTagId=null===e?void 0:e,c.duration=this.duration,c.properties=this.getProperties(n),c)]),u.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(e){var t;return Et(Et(Et(Et({},e),((t={})[At]=(new Date).getTime().toString(),t.QoSTransactionId=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}(),Bt=function(){return(Bt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Rt=(function(){function e(e,t,n,r){var i=this;this.eventHubPromise=e,this.monitoringData=t,this.logVerbose=n,this.staticProperties=r,this.errorMap={},this.registerErrors=function(e,t){i.errorMap[e]=Bt({},t)},this.logEUPL=function(e,t,n,r){var o=wt.SUCCESS,a=e+"_"+o;i.eventHubPromise.then(function(s){return s.broadcastEvent({eventId:a,version:i.monitoringData.version?i.monitoringData.version:Ct,type:"EUPL",source:i.monitoringData.source,featureName:t,clientCorrelationid:i.monitoringData.clientCorrelationId,qosScenarioName:e,qosEventType:o,qosTagId:void 0,duration:n,properties:i.getProperties(r)})})}}e.prototype.startMonitor=function(e,t){var n=this;return new Lt(this.eventHubPromise,this.monitoringData,e,t,function(){return n.staticProperties()},function(e){return Promise.resolve(n.lookupError(e))},this.logVerbose())},e.prototype.logEvent=function(e){this.log(e,"Event")},e.prototype.logUserInteractionEvent=function(e){var t={exportType:"UserInteraction",exportName:e.eventId};e=Bt({exportOptions:t},e),this.log(e,"Event")},e.prototype.logError=function(e){this.log(e,"Error")},e.prototype.logTrace=function(e){this.log(e,"Trace")},e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush()})},e.prototype.destroy=function(){return this.eventHubPromise.then(function(e){return e.broadcastDestroy()})},e.prototype.setEventHub=function(e){this.eventHubPromise=Promise.resolve(e)},e.prototype.getEventHub=function(){return this.eventHubPromise},e.prototype.getStaticProperties=function(){return this.staticProperties},e.prototype.setStaticProperties=function(e){this.staticProperties=e},e.prototype.lookupError=function(e){if(!f(e))return"Invalid midgardError";var t=this.errorMap[e.family];if(!t)return"Unknown family "+e.family+": "+e.code;var n=t[e.code];return n?e.family+": "+n:"Unknown code: "+e.family+": "+e.code},e.prototype.log=function(e,t){!g(e.featureName)||v(e.featureName)&&!this.logVerbose()||this.broadcastEvent(e.eventId,e.featureName,t,e.exportOptions,e.properties)},e.prototype.broadcastEvent=function(e,t,n,r,i){var o=this;e&&this.monitoringData.source&&this.monitoringData.clientCorrelationId&&this.eventHubPromise.then(function(a){return a.broadcastEvent({eventId:e,version:o.monitoringData.version?o.monitoringData.version:Ct,type:n,midgardError:i&&f(i.midgardError)?o.lookupError(i.midgardError):void 0,source:o.monitoringData.source,featureName:t,clientCorrelationid:o.monitoringData.clientCorrelationId,qosScenarioName:void 0,qosEventType:void 0,qosTagId:void 0,duration:void 0,exportOptions:r,properties:o.getProperties(i)})})},e.prototype.getProperties=function(e){var t;return Bt(Bt(Bt(((t={})[At]=(new Date).getTime().toString(),t),this.monitoringData.properties),this.staticProperties()),e)}}(),function(){return Promise.resolve(re.AWTLogManager)}),xt=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Mt=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Ut=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return xt(this,void 0,void 0,function(){return Mt(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,Rt()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return xt(this,void 0,void 0,function(){var n;return Mt(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return xt(this,void 0,void 0,function(){var t,n,r;return Mt(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,Rt()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20210419.6.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getCollectorUrlAsync=function(){return xt(this,void 0,void 0,function(){return Mt(this,function(e){switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,re.AWT_COLLECTOR_URL_GERMANY];case"GccHigh":return[2,re.AWT_COLLECTOR_URL_USGOV_DOJ];case"DoD":return[2,re.AWT_COLLECTOR_URL_USGOV_DOD];case"AG08":case"AG09":return[2,""];case"Gallatin":case"GccModerate":case"Prod":default:return[2,void 0]}return[2]})})},e.prototype.noOp=function(){},e}(),Wt=function(){return(Wt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Nt=new Map,Gt=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ft=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},jt=2,Ht=0,zt=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},qt=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Vt=2,Xt="livepersonacard_with-react",Qt="livepersonacard_without-react",Kt="livepersonacardstrings",Zt="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",Jt="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",$t="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",Yt="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",en="e5ad760145754ffc9704e67c800087f2-e2685720-0f91-4c64-acd6-32359f3b1c29-6998",tn="",nn="";!function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration",e.getLpeBundles="GetLpeBundlesDuration",e.getLpeBundlesFromStart="GetLpeBundlesFromStartDuration"}(Pt||(Pt={}));var rn,on=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),an=["msit","df","ppe"],sn=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09"],cn=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},un=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},ln=2,pn=0,dn="livepersonaeditor_with-react",fn="livepersonaeditor_without-react",hn="livepersonaeditorstrings",vn="iscapiv3enabled",gn="withreact",yn=function(){return(yn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},mn=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},_n=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},bn=!1,Tn=function(){return(Tn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Sn=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Pn=function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};try{var Cn=window.document.createElement("link"),An=Boolean("onmscontentzoom"in window.document);Cn.rel=An?"dns-prefetch":"preconnect",Cn.href="https://lpcres.delve.office.com/",window.document.head.appendChild(Cn)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}}])})},2230:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var o=n(87),a=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},s=function(e,t){return function(n,o){return void 0===o&&(o=!1),r(void 0,void 0,void 0,function(){var r;return i(this,function(i){return(r=e.getChatConversationWith(n))?[2,t.placeCall({conversationId:r.id,withVideo:o,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]:[2,Promise.reject("Cannot find the chat")]})})}},c=function(e,t){return function(n,r){var i=e.getChatConversationWith(n);if(!i)return Promise.reject("Cannot find the chat");var o=SkypeX.Services.Utilities.newClientMessageId();return t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:o,externalId:null,draftObjectId:null,inlineImages:null})}},u=function(e,t,n,a,s,c){return function(u,l){var p=u.persona;return r(void 0,void 0,void 0,function(){var r,u,d,f,h,v;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Starting chat"),r=n.getFreshnessInMs(),u=e.scenarios.people.lpcStartChat,[4,n.getAllPeopleProfile([p.TeamsMri],u,!1,!1,r)];case 1:return d=i.sent()[0],f=a.getPrivateChatUserMri(d,u),[4,s({groupName:d.displayName,peopleSlug:f,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 2:return i.sent(),l(!0),c(o.LpcCallbackTelemetryType.lpcStartChat,p.TeamsMri),[3,4];case 3:return h=i.sent(),v="Failed to navigate to chat",t.error(v),l(!1,v),[3,4];case 4:return[2]}})})}},l=function(e,t,n,a,s,c){return function(a,u){return r(void 0,void 0,void 0,function(){var r,l,p,d,f;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),r=n.getFreshnessInMs(),l=e.scenarios.people.lpcOrgChart,[4,n.getAllPeopleProfile([a.TeamsMri],l,!1,!1,r)];case 1:return p=i.sent()[0],[4,s({groupName:p.displayName,slug:a.TeamsMri,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return i.sent(),u(!0),c(o.LpcCallbackTelemetryType.lpcOrgChart,a.TeamsMri),[3,4];case 3:return d=i.sent(),f="Failed to navigate to org chat",t.error(f),u(!1,f),[3,4];case 4:return[2]}})})}},p=function(e,t,n){return function(a,s){return r(void 0,void 0,void 0,function(){var r,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(a.TeamsMri)];case 1:return i.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcAudioCall,a.TeamsMri),[3,3];case 2:return r=i.sent(),c="Failed to start audio call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},d=function(e,t,n){return function(a,s){return r(void 0,void 0,void 0,function(){var r,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(a.TeamsMri,!0)];case 1:return i.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcVideoCall,a.TeamsMri),[3,3];case 2:return r=i.sent(),c="Failed to start video call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},f=function(e,t,n){return function(a,s,c){return r(void 0,void 0,void 0,function(){var r,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Sending message to user, message length {0}",s&&s.length),[4,t(a.TeamsMri,s)];case 1:return i.sent(),c(!0),n(o.LpcCallbackTelemetryType.lpcQuickIM,a.TeamsMri),[3,3];case 2:return r=i.sent(),u="Failed to send message",e.error(u),c(!1,u),[3,3];case 3:return[2]}})})}},h=function(e,t,n,a){return function(s,c){return r(void 0,void 0,void 0,function(){var r,u,l;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e.info("LPC::Blocking contact"),(r=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(r.id,!1,"LivePersonaCard")]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,n.addBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:i.sent(),i.label=4;case 4:return c(!0),a(o.LpcCallbackTelemetryType.lpcBlockContact,s.TeamsMri),[3,6];case 5:return u=i.sent(),l="Failed to block contact",e.error(l),c(!1,l),[3,6];case 6:return[2]}})})}},v=function(e,t,n,a){return function(s,c){return r(void 0,void 0,void 0,function(){var r,u,l;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e.info("LPC::Unblocking contact"),(r=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(r.id,!0,"LivePersonaCard")]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,n.deleteBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:i.sent(),i.label=4;case 4:return c(!0),a(o.LpcCallbackTelemetryType.lpcUnblockContact,s.TeamsMri),[3,6];case 5:return u=i.sent(),l="Failed to unblock contact",e.error(l),c(!1,l),[3,6];case 6:return[2]}})})}},g=function(e,t,n,a,s){return function(c,u){return r(void 0,void 0,void 0,function(){var r,l,p,d;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,a.getMeMSAProfile(n.scenarios.people.lpcEditProfile,!1)];case 1:return r=i.sent(),l=n.appHeaderBar.buttonid.profileButton,t.open(n.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[l],user:r,isMSAEditNameClick:!0}),u(!0),s(o.LpcCallbackTelemetryType.lpcEditMeProfile,c.TeamsMri),[3,3];case 2:return p=i.sent(),d="Failed to edit me user profile",e.error(d),u(!1,d),[3,3];case 3:return[2]}})})}},y=function(e,t,n,a,s){if(n.valueAsBoolean(a.settings.names.enableManageAliasPrivacy))return function(n,c){return r(void 0,void 0,void 0,function(){var r;return i(this,function(i){try{e.info("LPC::Manage discoverability settings"),t.open(a.dialogs.manageAliasPrivacyDialog,{backButtonShouldOpenSettings:!0}),c(!0),s(o.LpcCallbackTelemetryType.lpcManageDiscoverabilitySettings,n.TeamsMri)}catch(t){r="Failed to manage discoverability settings",e.error(r),c(!1,r)}return[2]})})}};t.LPCActionCallbackFactory=function(e,t,n,r,i,o,m,_,b,T,S,P){var C=a(t,e,o),A=s(i,m),w=c(i,_);return{startChat:u(t,n,r,i,C,P),showOrgChart:l(t,n,r,0,C,P),sendQuickMessage:f(n,w,P),startVideoCall:d(n,A,P),startAudioCall:p(n,A,P),blockContact:h(n,i,b,P),unblockContact:v(n,i,b,P),editMeProfile:g(n,T,t,r,P),manageDiscoverabilitySettings:y(n,T,S,t,P)}}},2231:function(e,t,n){"use strict";function r(e){return e&&validator.isEmail(e)}function i(e,t,n){var r=this;return function(i,o,a){return c(r,void 0,void 0,function(){var r,o,s,c,l,p;return u(this,function(u){switch(u.label){case 0:r=t.service.newScenario(n.scenarios.people.lpcGetOrgChart),o=i.TeamsMri||i.Smtp||i.Upn,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.getOrgChart(o)];case 2:return(s=u.sent())?(c=d.getDirectReportsAndManager(s.value),r.stop(),a(c,void 0)):(p="No orgChart returned",t.error(p),r.stop({reason:p}),a(void 0,p)),[3,4];case 3:return l=u.sent(),p="Exception in orgChart call",t.error("getOrgChart failed in LPC data callback"),r.fail({reason:p}),a(void 0,p),[3,4];case 4:return[2]}})})}}function o(e,t,n,r,i,o){var a=this;return function(s,l,f){return c(a,void 0,void 0,function(){var a,c,l,h,v,g,y,m,_,b,T,S,P,C,A,w,I;return u(this,function(u){switch(u.label){case 0:a=t.service.newScenario(i.scenarios.people.lpcGetHeaderInfo),c=s.TeamsMri||s.Smtp||s.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),l=p.deserializeHostAppPersonaId(s.HostAppPersonaId),h=l.isSharedChannel,v=l.hostTenantId,g=l.hostConversationId,y=l.isExchangeOnlyContact,m=void 0,h?[4,e.getAllPeopleProfileForConversation([c],g,!1,i.scenarios.people.lpcGetHeaderInfoSC,void 0,h,v)]:[3,3];case 2:return m=u.sent(),a.mark(i.scenarios.people.lpcGetHeaderInfoSC),[3,7];case 3:return y?[4,d.getPersonaProfileByContactId(s.OlsPersonaId,t,o,a,i.scenarios.people.lpcGetHeaderInfoEC)]:[3,5];case 4:return(m=u.sent())?[3,7]:[2,f(void 0,"No profile returned for exchange contact in LPC getHeaderInfoAndCardType callback")];case 5:return[4,e.getAllPeopleProfile([c],i.scenarios.people.lpcGetHeaderInfo,!Boolean(s.TeamsMri))];case 6:m=u.sent(),a.mark(i.scenarios.people.lpcGetHeaderInfo),u.label=7;case 7:return(_=m[0])?(b=_,T=n.getCurrentSkypeMri(),S=T===s.TeamsMri,P=p.determineCardTypeForTargetUser(b.role,b.type,S),C=r.valueAsBoolean(i.settings.names.showOnlySearchablePhonesAndEmailsInLPC),A=k(P,b,C),a.stop(),f(A,void 0)):(I="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),a.fail({reason:I}),f(void 0,I)),[3,9];case 8:return w=u.sent(),I="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),a.fail({reason:I}),f(void 0,I),[3,9];case 9:return[2]}})})}}function a(e,t,n,r,i){var o=this;return function(a,s){return c(o,void 0,void 0,function(){var o,c,l,f,h,v,g,y,m,_,b,T,S,P,C;return u(this,function(u){switch(u.label){case 0:o=t.service.newScenario(r.scenarios.people.lpcGetPersonaInfo),c=a.TeamsMri||a.Smtp||a.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),l=p.deserializeHostAppPersonaId(a.HostAppPersonaId),f=l.isSharedChannel,h=l.hostTenantId,v=l.hostConversationId,g=l.isExchangeOnlyContact,y=void 0,f?[4,e.getAllPeopleProfileForConversation([c],v,!1,r.scenarios.people.lpcGetPersonaInfoSC,void 0,f,h)]:[3,3];case 2:return y=u.sent(),o.mark(r.scenarios.people.lpcGetPersonaInfoSC),[3,7];case 3:return g?[4,d.getPersonaProfileByContactId(a.OlsPersonaId,t,i,o,r.scenarios.people.lpcGetPersonaInfoEC)]:[3,5];case 4:return(y=u.sent())?[3,7]:[2,s(void 0,"No profile returned for exchange contact in LPC getPersonaInfo callback")];case 5:return[4,e.getAllPeopleProfile([c],r.scenarios.people.lpcGetPersonaInfo,!Boolean(a.TeamsMri))];case 6:y=u.sent(),o.mark(r.scenarios.people.lpcGetPersonaInfo),u.label=7;case 7:return(m=y[0])?(_=m,b=f&&!!_.xtapUser,T=n.valueAsBoolean(r.settings.names.showOnlySearchablePhonesAndEmailsInLPC),S={hostAppPersonaId:a.HostAppPersonaId,aadObjectId:_.objectId,email:d.getEmail(_,T),extraEmails:d.getEmails(_,T),upn:_.userPrincipalName,userType:p.determineLPCPersonaType(_.role,_.type),displayName:_.displayName,firstName:_.givenName,lastName:_.surname,skypeId:_.skypeId,isInformationBarrierBarred:_.isIbBarred,teamsMri:a.TeamsMri||_.mri,jobTitle:_.jobTitle,department:b?_.companyName:_.department,officeLocation:_.userLocation,phoneNumbersAndUrls:d.getPhoneNumbers(_,T)},o.stop(),s(S,void 0)):(C="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetPersonaInfo callback"),o.fail({reason:C}),s(void 0,C)),[3,9];case 8:return P=u.sent(),C="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetPersonaInfo callback"),o.fail({reason:C}),s(void 0,C),[3,9];case 9:return[2]}})})}}var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},c=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var l=n(87),p=n(308),d=n(2232);t.unescapeHtmlEntities=function(e){if(!e)return e;var t=document.createElement("textarea");return t.innerHTML=e,t.value};var f=function(e,t,n,i,o){return function(a,l){return c(void 0,void 0,void 0,function(){var c,f,h,v,g,y,m,_,b,T,S,P,C,A;return u(this,function(u){switch(u.label){case 0:if(c=e.service.newScenario(n.scenarios.people.lpcGetImageUri),f=p.deserializeHostAppPersonaId(a.HostAppPersonaId),h=f.isSharedChannel,v=f.hostTenantId,g=f.hostConversationId,y=f.isExchangeOnlyContact,m={mri:a.TeamsMri,principalName:a.Upn||a.Smtp||a.TeamsMri,displayName:a.DisplayName||"",size:n.profilePictureSizes.medium},_=!1,b=r(m.principalName),T=h&&!b,a.DisplayName&&!T)return[3,9];S=a.TeamsMri||a.Smtp||a.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),P=void 0,h?[4,i.getAllPeopleProfileForConversation([S],g,!0,n.scenarios.people.lpcGetImageUriSC,void 0,h,v)]:[3,3];case 2:return P=u.sent(),c.mark(n.scenarios.people.lpcGetImageUriSC),[3,7];case 3:return y?[4,d.getPersonaProfileByContactId(a.OlsPersonaId,e,o,c,n.scenarios.people.lpcGetImageUriEC)]:[3,5];case 4:return P=u.sent(),[3,7];case 5:return[4,i.getAllShortPeopleProfile([S],n.scenarios.people.lpcGetImageUri,!Boolean(a.TeamsMri))];case 6:P=u.sent(),c.mark(n.scenarios.people.lpcGetImageUri),u.label=7;case 7:return(C=P[0])&&(m=s(s({},m),{displayName:C.displayName}),T&&(m=s(s({},m),{principalName:C.userPrincipalName})),C.isIbBarred&&(_=!0)),[3,9];case 8:return A=u.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,9];case 9:return h&&(m=s(s({},m),{isSharedChannel:h,hostTenantId:v,conversationId:g})),y&&(m=s(s({},m),{isExchangeOnlyContact:y})),t.loadImage(m,!1,_,!1,h?n.scenarios.people.lpcGetImageUriSC:n.scenarios.people.lpcGetImageUri).then(function(e){var t=e&&e.imgUrl||"";c.stop(),l(t,{})}).catch(function(e){c.fail({reason:"Failed to fetch persona"}),l(void 0,void 0,e)}),[2]}})})}};t.getSkypeConsumerChatStatus=function(e,t,n){var r=t.findConversationWith(n);if(r&&r.isSfC())return r.InteropConversationStatus()===e.interopConversationStatus.blocked?l.PersonaPresence.blocked:l.PersonaPresence.none};var h=function(e,n,r,i,o,a){var s=t.getSkypeConsumerChatStatus(r,i,a);if(void 0!==s)return s;if(o.isBlockedContact(a))return l.PersonaPresence.blocked;var c=e.status,u=e.flwPresence;if(n.valueAsBoolean(r.settings.names.enableFlwPresence)){if(u===SkypeX.Services.UserFlwPresence.OffShift)return l.PersonaPresence.offline;if(u===SkypeX.Services.UserFlwPresence.OnShift)switch(c){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return l.PersonaPresence.busy;default:return l.PersonaPresence.online}}switch(c){case SkypeX.Services.UserStatus.Online:return l.PersonaPresence.online;case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return l.PersonaPresence.offline;case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return l.PersonaPresence.away;case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return l.PersonaPresence.busy;case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return l.PersonaPresence.dnd;default:return l.PersonaPresence.offline}},v=function(e,t,n,r,i,o,a){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),u=c.length>0?c[c.length-1]:null;u&&(t=o.instant(a.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:u}))}return o.instant(a.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},g=function(e,t,n,r,i,o,a,s,c){var u=e.status,l=e.calendarData,p=e.lastSeenAt,d=e.flwPresence,f=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(d===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(d===SkypeX.Services.UserFlwPresence.OnShift){var h=void 0,g=void 0,y=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(f);switch(y&&y.currentShift&&(h=c.getDate(new Date(y.currentShift.endTime),"shortTime"),g=y.currentShift.teamOlsonCode),u){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var m=r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(u),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return v(m,h,g,s,c,r,o);default:var _=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return v(_,h,g,s,c,r,o)}}}var b=p&&(new Date).getTime()-p.getTime()<=i.timeInMiliseconds.year;if(l&&l.isOutOfOffice)switch(u){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(u),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return b?a.transformIntoTimeago(p):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(u){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return b?a.transformIntoTimeago(p):n.GetTranslatedStatusText(u);default:return n.GetTranslatedStatusText(u)}},y=function(e,t,n,r,i){var o="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(o=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),o},m=function(e,t,n,r,i,o){var a={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var u=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(u)}if(s){var l=r.stripHtml(i.sanitizeHtml(s)).trim(),p=y(e,0,0,r,i);l.length&&!p.length&&(a.message=l)}}return a.message&&a.publishTime?a:void 0},b=function(e,n,r,i){var o=[],a=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=e.decodeHtml(i.attribs["data-itemprops"]),u=d.removeZeroWidthSpace(c),l=JSON.parse(u).mri;o.push({text:t.unescapeHtmlEntities(s),hostAppPersonaId:l,mri:l})}else"text"===i.type?o.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i)),hostAppPersonaId:void 0}):"br"===i.name?o.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&a(i.children)})};return a(i),o},T=function(e,t,n,r,i,o){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var a={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var u=i.sanitizeHtml(s).trim(),l=window.htmlparser2,p=l.parseDOM("<div>"+u+"</div>"),d=b(r,n,l,p);a.message=d}if(c&&c.trim()){var f=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(f)}return a.message.length&&a.publishTime?a:void 0}},S=function(e,t,n,r,i,o,a,s,c,u,l,p,d,f){return function(v,_){var b=e.getPresence(v,_);return{presence:h(b,i,o,d,f,v),isOutOfOffice:b&&!!b.calendarData&&!!b.calendarData.isOutOfOffice,oofMessage:b&&y(b,0,0,t,n),presenceText:b&&g(b,i,a,s,o,c,u,l,p),statusNote:b&&m(b,0,0,t,n,r),statusNoteV2:b&&T(b,i,o,t,n,r)}}},P=function(e){return function(t){var n=e.findConversationWith(t);return n&&n.isInteropChat()?SkypeX.Services.PresenceSource.SFB:SkypeX.Services.PresenceSource.UPS}},C=function(e,t,n,r,i,o,a,s,c,u,l,d,f,h,v){return function(g,y){if(p.deserializeHostAppPersonaId(g.HostAppPersonaId).isExchangeOnlyContact)return y(null,void 0);var m=v.service.newScenario(a.scenarios.people.lpcGetRichPresence),_=P(e),b=S(t,n,r,i,o,a,s,c,u,l,d,f,e,h)(g.TeamsMri,_(g.TeamsMri));m.stop(),y(b,void 0)}},A=function(e,t,n,r,i,o,a,s){return function(l){return c(void 0,void 0,void 0,function(){var c,d,f,h,v,g,y,m,_,b,T,S,P,C,A,w,I,k,E,O,D,L,B,R,x;return u(this,function(u){switch(u.label){case 0:if(c=r.service.newScenario(i.scenarios.people.lpcGetHeaderActionsPolicy),d=!s.isCurrentUserTFLOrMsaAccount(),f={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:!1,disableBlockUnblock:d},h=a.isBlockedContact(l.TeamsMri))return c.stop({reason:"Blocked Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:d}];v=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),f.disableCall=!v,f.disableVideo=!v,g=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),u.label=1;case 1:return u.trys.push([1,6,,7]),y=p.deserializeHostAppPersonaId(l.HostAppPersonaId),m=y.isSharedChannel,_=y.hostTenantId,b=y.hostConversationId,(T=y.isExchangeOnlyContact)?(c.stop({reason:"Out-of-tenant outlook Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}]):(S=void 0,m?[4,n.getAllPeopleProfileForConversation([l.TeamsMri],b,!1,i.scenarios.people.lpcGetHeaderActionsPolicySC,void 0,m,_)]:[3,3]);case 2:return S=u.sent(),c.mark(i.scenarios.people.lpcGetHeaderActionsPolicySC),[3,5];case 3:return[4,n.getAllPeopleProfile([l.TeamsMri],i.scenarios.people.lpcGetHeaderActionsPolicy,!l.TeamsMri)];case 4:S=u.sent(),c.mark(i.scenarios.people.lpcGetHeaderActionsPolicy),u.label=5;case 5:if(P=S[0]){if(C=P.featureSettings,A=P.type,w=P.userType,I=P.isAnonymousUser,k=P.mri,E=P.isIbBarred,I||E)return I?c.stop({reason:"Anonymous User"}):c.stop({reason:"IB Barred User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}];if(O=SkypeX.Services.ChatServiceUtils.isPstnMri(k))return c.stop({reason:"PSTN User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!1,disableVideo:!0,disableBlockUnblock:!0}];D=C&&C.isPrivateChatEnabled,L=A&&A.toLowerCase()===i.userTypes.person.toLowerCase(),B=w&&w.toLowerCase()===i.userTypes.guest.toLowerCase(),R=o===teamspace.services.UserTypeInTenant.Guest,f.disableChat=!1===D||!g,f.disableOrg=!(L&&!B)||R,c.stop()}return[3,7];case 6:return x=u.sent(),c.fail({reason:"Error while fetching persona"}),r.error("Failed to fetch persona profile in LPC data callbacks"),[3,7];case 7:return[2,f]}})})}},w=function(e,t,n){var r=d.getEmail(t,n);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:t.displayName,firstName:t.givenName,lastName:t.surname,title:t.jobTitle,department:t.department,location:t.userLocation,profilePictureUrl:t.imageUri,mobilePhone:t.mobile,phone:d.getPhoneNumber(t,n),userPrincipalName:t.userPrincipalName,email:r&&r.Address,imAddress:t.skypeId}}}},I=function(e,t){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:t}}}},k=function(e,t,n){return"NotResolved"===e?I(e,t.email):w(e,t,n)};t.makeGetHeaderInfoAndCardTypeCallback=o,t.GetPresenceSourceFunction=P,t.GetRichPresenceFunction=S,t.LPCDataCallbackFactory=function(e,t,n,r,s,c,u,l,p,d,h,v,g,y,m,_,b,T,S,P,w,I,k){return{getAndPrefetchPersonaImageUri:f(e,_,p,r,k),getRichPresence:C(t,n,s,c,u,l,p,d,h,v,g,y,m,b,e),getHeaderActionsPolicyAsync:A(T,S,r,e,p,P,b,I),getPersonaInfo:a(r,e,l,p,k),getOrgChart:i(r,e,p),getHeaderInfoAndCardType:o(r,e,w,l,p,k)}}},2232:function(e,t,n){"use strict";function r(e,t){var n=[];return e.emailsInfo&&e.emailsInfo.forEach(function(e){!e.searchable&&t||n.push({Address:e.address})}),n}function i(e,t){if(t){var n=[];return e.phonesInfo&&e.phonesInfo.forEach(function(e){e.searchable&&n.push({PhoneNumber:e.number,Type:"Home",PhoneUrl:"tel:"+e.number})}),n}var r=[];return e.phones&&e.phones.length>0&&e.phones.forEach(function(e){return r.push({PhoneNumber:e.number,PhoneUrl:"tel:"+e.number,Type:e.type})}),e.telephoneNumber&&r.push({PhoneNumber:e.telephoneNumber,PhoneUrl:"tel:"+e.telephoneNumber,Type:"Business"}),r}var o=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0}),t.getDirectReportsAndManager=function(e){return{Managers:e.filter(function(e){return 1===e.managerLevel}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}}),Directs:e.filter(function(e){return!e.userClassification}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}})}},t.getEmails=r,t.getEmail=function(e,t){if(!t)return e.email?{Address:e.email}:void 0;var n=r(e,t);return n.length>0?n[0]:void 0},t.getPhoneNumbers=i,t.getPhoneNumber=function(e,t){if(t){var n=i(e,t);if(n.length>0){var r=n[0];return{number:r.PhoneNumber,type:r.Type,url:r.PhoneUrl}}}else{if(e.telephoneNumber)return{number:e.telephoneNumber,type:"Business",url:"tel:"+e.telephoneNumber};if(e.phones&&e.phones.length>0){var o=e.phones[0];return{number:o.number,type:o.type,url:"tel:"+o.number}}}},t.removeZeroWidthSpace=function(e){var t=/[\u200B-\u200D\uFEFF]/g;return e.replace(t,"")},t.getPersonaProfileByContactId=function(e,t,n,r,i){return o(this,void 0,void 0,function(){var o,s,c;return a(this,function(a){switch(a.label){case 0:return e?[4,n.getCachedExchangeContactById(e)]:[3,2];case 1:return(s=a.sent())?o=[{displayName:n.getDisplayNameForUserContact(s),id:s.id,jobTitle:s.jobTitle,mri:s.mri,phones:s.phones,email:s.emails[0]||"",objectId:s.id}]:(c="No profile returned for exchange contact",t.error("getCachedExchangeContactById returned no profile in LPC {0}",i),r.fail({reason:c})),[3,3];case 2:c="Empty OlsPersonaId to look for Exchange contact profile",t.error("Empty OlsPersonaId to look for Exchange contact profile in LPC {0}",i),r.fail({reason:c}),a.label=3;case 3:return o&&r.mark(i),[2,o]}})})}},2233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2234);t.defaultTheme=r.defaultTheme;var i=n(2235);t.darkTheme=i.darkTheme;var o=n(2236);t.highContrastTheme=o.highContrastTheme},2234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="rgba(37,36,36,0.75)",i={themePrimary:r,themeSecondary:r,neutralPrimary:"#252424",neutralSecondary:r,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#6264a7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)"};t.defaultTheme={palette:i}},2235:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#a6a7dc",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff"},t.darkTheme={palette:t.darkThemePalette}},2236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#000000",i="#ffffff",o={themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:i,neutralSecondary:"#ffffff",neutralLight:r,neutralLighter:i,neutralLighterAlt:i,neutralPrimaryAlt:r,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:r,neutralQuaternary:r,neutralQuaternaryAlt:i,white:r,black:i,purple:"#ffff00",magenta:i,magentaDark:r};t.highContrastTheme={palette:o}},2237:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.components.PanelActionGesture,i=teamspace.components.PanelActionOutcome,o=teamspace.components.PanelActionScenario,a=teamspace.components.PanelActionScenarioType,s=teamspace.components.PanelModuleName,c=teamspace.components.PanelModuleType,u=teamspace.components.WorkLoad,l=teamspace.components.SubWorkLoad,p=n(87),d=function(){function e(e,t,n){this.analyticsService=e,this.loggingService=t,this.conversationsService=n}return e.prototype.logPanelActionEvent=function(e,t){var n,d,f,h,v,g,y=this,m=c.people,_=i.nav,b=i.nav,T=a.people,S=teamspace.PanelRegion.popover,P=u.chatContent,C=l.composeMsg;switch(e){case p.LpcCallbackTelemetryType.lpcAudioCall:d=r.click,f=o.navCalling,h=s.lpcAudioCall,n="lpcAudioCall";break;case p.LpcCallbackTelemetryType.lpcStartChat:d=r.click,f=o.navChat,h=s.lpcStartChat,n="lpcStartChat";break;case p.LpcCallbackTelemetryType.lpcOrgChart:d=r.click,f=o.orgChart,h=s.lpcOrgChart,n="lpcOrgChart";break;case p.LpcCallbackTelemetryType.lpcQuickIM:d=r.click,_=i.submit,b=i.submit,f=o.quickIM,h=s.lpcQuickIM,v=s.sendButton,g=c.compose,n="lpcQuickIM";break;case p.LpcCallbackTelemetryType.lpcVideoCall:d=r.click,f=o.navCalling,h=s.lpcVideoCall,n="lpcVideoCall";break;case p.LpcCallbackTelemetryType.lpcBlockContact:d=r.click,f=o.blockUser,h=s.lpcBlockContact,n="lpcBlockContact";break;case p.LpcCallbackTelemetryType.lpcUnblockContact:d=r.click,f=o.unblockUser,h=s.lpcUnblockContact,n="lpcUnblockContact";break;default:return}var A={action:{gesture:d,outcome:_,outcomeNew:b,scenario:f?teamspace.shared.AttributeHelper.tryGetEnum(f.toString(),o,this.loggingService):null,scenarioType:T?teamspace.shared.AttributeHelper.tryGetEnum(T.toString(),a,this.loggingService):null,workLoad:teamspace.shared.AttributeHelper.tryGetEnum(P.toString(),u,this.loggingService),subWorkLoad:teamspace.shared.AttributeHelper.tryGetEnum(C.toString(),l,this.loggingService)},module:{name:h?teamspace.shared.AttributeHelper.tryGetEnum(h.toString(),s,this.loggingService):null,nameNew:v?teamspace.shared.AttributeHelper.tryGetEnum(v.toString(),s,this.loggingService):null,type:m?teamspace.shared.AttributeHelper.tryGetEnum(m.toString(),c,this.loggingService):null,typeNew:g?teamspace.shared.AttributeHelper.tryGetEnum(g.toString(),c,this.loggingService):null,summary:n},targetThread:this.getTargetThreadType(t)};this.analyticsService.getAnalyticsPanelActionEventData(A,S).then(function(e){y.analyticsService.sendPanelAction(e)})},e.prototype.getTargetThreadType=function(e){if(!e)return null;var t=this.conversationsService.getConversation(e);return{type:t&&t.conversationType||"OneOnOneChat"}},e}();t.LpcTelemetryHelper=d},308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.determineCardTypeForTargetUser=function(e,t,n){if(n)return"Me";switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e},t.serializeHostAppPersonaId=function(e){return JSON.stringify(e)},t.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0,isExchangeOnlyContact:!1};var t=JSON.parse(e);return{userId:t.userId,isSharedChannel:!0===t.isSharedChannel,hostTenantId:t.hostTenantId,hostConversationId:t.hostConversationId,isExchangeOnlyContact:!0===t.isExchangeOnlyContact}}},87:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark",e.DefaultV2="defaultV2",e.DarkV2="darkV2"}(t.LpcTheme||(t.LpcTheme={}));!function(e){e[e.lpcAudioCall=0]="lpcAudioCall",e[e.lpcStartChat=1]="lpcStartChat",e[e.lpcEditMeProfile=2]="lpcEditMeProfile",e[e.lpcOrgChart=3]="lpcOrgChart",e[e.lpcQuickIM=4]="lpcQuickIM",e[e.lpcVideoCall=5]="lpcVideoCall",e[e.lpcBlockContact=6]="lpcBlockContact",e[e.lpcUnblockContact=7]="lpcUnblockContact",e[e.lpcManageDiscoverabilitySettings=8]="lpcManageDiscoverabilitySettings",e[e.personImageCallback=9]="personImageCallback",e[e.richPresenceCallback=10]="richPresenceCallback"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}))}},[2227]);